{"version":3,"sources":["../src/harness/assertions/success.ts","../src/harness/assertions/helpers.ts","../src/harness/assertions/error.ts","../src/harness/assertions/contains-text.ts","../src/harness/assertions/response-time.ts","../src/harness/assertions/json-path.ts","../src/harness/assertions/regex.ts","../src/harness/assertions/index.ts","../src/harness/runner.ts","../src/harness/validation/schemas.ts","../src/harness/spec-loader.ts","../src/harness/reporters/json.ts","../src/harness/reporters/console.ts","../src/core/template-system/schemas.ts","../src/core/template-system/registry.ts","../src/core/template-system/processor.ts","../src/utils/json-schema-to-zod.ts","../src/utils/example-generator.ts","../src/utils/error-formatter.ts","../src/services/cache.ts","../src/index.ts"],"names":["parseYAML","stringifyYAML","z","readFile","readdir","join","dirname"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * Success Assertion\n *\n * Verifies that the tool call succeeded (no error).\n */\n\nimport type { MCPToolResponse } from \"../types/client.js\";\nimport type { AssertionResult } from \"../types/results.js\";\n\n/**\n * Check if tool call was successful\n *\n * @param response - MCP tool response\n * @returns Assertion result\n */\nexport function checkSuccess(response: MCPToolResponse): AssertionResult {\n\tconst isError = response.isError === true;\n\n\tif (isError) {\n\t\treturn {\n\t\t\ttype: \"success\",\n\t\t\tpassed: false,\n\t\t\tmessage: \"Tool call returned an error\",\n\t\t\texpected: \"success\",\n\t\t\tactual: \"error\",\n\t\t};\n\t}\n\n\treturn {\n\t\ttype: \"success\",\n\t\tpassed: true,\n\t\tmessage: \"Tool call succeeded\",\n\t};\n}\n","/**\n * Assertion Helpers\n *\n * Shared utility functions for assertions.\n */\n\nimport type {\n\tMCPToolResponse,\n\tMCPPromptResponse,\n\tMCPResourceContent,\n} from \"../types/client.js\";\n\n/** Union type for all MCP response types */\nexport type MCPResponse = MCPToolResponse | MCPPromptResponse | MCPResourceContent;\n\n/**\n * Get text content from any MCP response\n *\n * Helper function to extract text from various response types.\n *\n * @param response - MCP response (tool, prompt, or resource)\n * @returns Concatenated text content\n */\nexport function getResponseText(response: MCPResponse): string {\n\t// Handle tool responses\n\tif (\"content\" in response && Array.isArray(response.content)) {\n\t\treturn response.content\n\t\t\t.filter((item) => item.type === \"text\")\n\t\t\t.map((item) => item.text)\n\t\t\t.join(\"\\n\");\n\t}\n\n\t// Handle prompt responses\n\tif (\"messages\" in response && Array.isArray(response.messages)) {\n\t\treturn response.messages\n\t\t\t.map((msg) => {\n\t\t\t\tif (msg.content.type === \"text\") {\n\t\t\t\t\treturn msg.content.text || \"\";\n\t\t\t\t}\n\t\t\t\treturn \"\";\n\t\t\t})\n\t\t\t.join(\"\\n\");\n\t}\n\n\t// Handle resource responses\n\tif (\"contents\" in response && Array.isArray(response.contents)) {\n\t\treturn response.contents\n\t\t\t.filter((item) => item.text)\n\t\t\t.map((item) => item.text)\n\t\t\t.join(\"\\n\");\n\t}\n\n\t// Unknown response type\n\treturn \"\";\n}\n","/**\n * Error Assertion\n *\n * Checks that a tool call resulted in an error.\n *\n * Design: Fully portable, no project-specific dependencies\n */\n\nimport type { AssertionResult } from \"../types/results.js\";\nimport type { MCPToolResponse } from \"../types/client.js\";\nimport { getResponseText } from \"./helpers.js\";\n\n/**\n * Check that the tool call resulted in an error\n *\n * @param response - MCP tool response\n * @param messageContains - Optional text that error message should contain\n * @returns Assertion result\n */\nexport function checkError(response: MCPToolResponse, messageContains?: string): AssertionResult {\n\t// Check if response indicates an error\n\tif (!response.isError) {\n\t\treturn {\n\t\t\ttype: \"error\",\n\t\t\tpassed: false,\n\t\t\tmessage: \"Expected tool call to fail, but it succeeded\",\n\t\t\texpected: \"error\",\n\t\t\tactual: \"success\",\n\t\t};\n\t}\n\n\t// If messageContains is specified, check error message\n\tif (messageContains) {\n\t\tconst responseText = getResponseText(response);\n\n\t\tif (!responseText.toLowerCase().includes(messageContains.toLowerCase())) {\n\t\t\treturn {\n\t\t\t\ttype: \"error\",\n\t\t\t\tpassed: false,\n\t\t\t\tmessage: `Error message does not contain expected text: \"${messageContains}\"`,\n\t\t\t\texpected: `error containing \"${messageContains}\"`,\n\t\t\t\tactual: responseText.substring(0, 200),\n\t\t\t};\n\t\t}\n\t}\n\n\treturn {\n\t\ttype: \"error\",\n\t\tpassed: true,\n\t\tmessage: messageContains\n\t\t\t? `Tool call failed as expected with message containing \"${messageContains}\"`\n\t\t\t: \"Tool call failed as expected\",\n\t};\n}\n","/**\n * Contains Text Assertions\n *\n * Verifies that response contains (or doesn't contain) specific text.\n */\n\nimport type { AssertionResult } from \"../types/results.js\";\nimport { getResponseText, type MCPResponse } from \"./helpers.js\";\n\n/**\n * Check if response contains specific text\n *\n * @param response - MCP response (tool, prompt, or resource)\n * @param text - Text to search for\n * @param caseInsensitive - Case insensitive matching\n * @returns Assertion result\n */\nexport function checkContainsText(\n\tresponse: MCPResponse,\n\ttext: string,\n\tcaseInsensitive = false,\n): AssertionResult {\n\tconst responseText = getResponseText(response);\n\tconst searchText = caseInsensitive ? text.toLowerCase() : text;\n\tconst targetText = caseInsensitive ? responseText.toLowerCase() : responseText;\n\n\tconst contains = targetText.includes(searchText);\n\n\tif (!contains) {\n\t\treturn {\n\t\t\ttype: \"contains_text\",\n\t\t\tpassed: false,\n\t\t\tmessage: `Response does not contain expected text: \"${text}\"`,\n\t\t\texpected: `text containing \"${text}\"`,\n\t\t\tactual: responseText.substring(0, 200), // First 200 chars\n\t\t};\n\t}\n\n\treturn {\n\t\ttype: \"contains_text\",\n\t\tpassed: true,\n\t\tmessage: `Response contains expected text: \"${text}\"`,\n\t};\n}\n\n/**\n * Check if response does NOT contain specific text\n *\n * @param response - MCP response (tool, prompt, or resource)\n * @param text - Text that should not be present\n * @param caseInsensitive - Case insensitive matching\n * @returns Assertion result\n */\nexport function checkNotContainsText(\n\tresponse: MCPResponse,\n\ttext: string,\n\tcaseInsensitive = false,\n): AssertionResult {\n\tconst responseText = getResponseText(response);\n\tconst searchText = caseInsensitive ? text.toLowerCase() : text;\n\tconst targetText = caseInsensitive ? responseText.toLowerCase() : responseText;\n\n\tconst contains = targetText.includes(searchText);\n\n\tif (contains) {\n\t\treturn {\n\t\t\ttype: \"not_contains_text\",\n\t\t\tpassed: false,\n\t\t\tmessage: `Response should not contain text: \"${text}\"`,\n\t\t\texpected: `text not containing \"${text}\"`,\n\t\t\tactual: responseText.substring(0, 200), // First 200 chars\n\t\t};\n\t}\n\n\treturn {\n\t\ttype: \"not_contains_text\",\n\t\tpassed: true,\n\t\tmessage: `Response does not contain unwanted text: \"${text}\"`,\n\t};\n}\n","/**\n * Response Time Assertion\n *\n * Verifies that the tool response time is within acceptable limits.\n */\n\nimport type { AssertionResult } from \"../types/results.js\";\n\n/**\n * Check if response time is within maximum threshold\n *\n * @param duration - Actual response time in milliseconds\n * @param maxMs - Maximum acceptable response time in milliseconds\n * @returns Assertion result\n */\nexport function checkResponseTime(duration: number, maxMs: number): AssertionResult {\n\tconst withinLimit = duration <= maxMs;\n\n\tif (!withinLimit) {\n\t\treturn {\n\t\t\ttype: \"response_time_ms\",\n\t\t\tpassed: false,\n\t\t\tmessage: `Response time ${duration}ms exceeds maximum ${maxMs}ms`,\n\t\t\texpected: ` ${maxMs}ms`,\n\t\t\tactual: `${duration}ms`,\n\t\t};\n\t}\n\n\treturn {\n\t\ttype: \"response_time_ms\",\n\t\tpassed: true,\n\t\tmessage: `Response time ${duration}ms is within limit (${maxMs}ms)`,\n\t};\n}\n","/**\n * JSON Path Assertion\n *\n * Verifies values at specific JSON paths in the response.\n */\n\nimport type { AssertionResult } from \"../types/results.js\";\nimport { getResponseText, type MCPResponse } from \"./helpers.js\";\n\n/**\n * Simple JSON path evaluator\n *\n * Supports basic paths like:\n * - $.property\n * - $.property.nested\n * - $.array[0]\n * - $.array[*].property\n *\n * @param obj - Object to query\n * @param path - JSON path expression\n * @returns Value at path or undefined\n */\nfunction evaluateJsonPath(obj: any, path: string): any {\n\t// Remove leading $. if present\n\tconst normalizedPath = path.replace(/^\\$\\.?/, \"\");\n\n\tif (!normalizedPath) {\n\t\treturn obj;\n\t}\n\n\t// Split path into segments\n\tconst segments = normalizedPath.split(/\\.|\\[/).map((s) => s.replace(/\\]/, \"\"));\n\n\tlet current = obj;\n\n\tfor (const segment of segments) {\n\t\tif (current === undefined || current === null) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Handle array wildcard [*]\n\t\tif (segment === \"*\") {\n\t\t\tif (!Array.isArray(current)) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\t// For wildcards, we'll just return the array for now\n\t\t\t// More complex wildcard handling can be added later\n\t\t\treturn current;\n\t\t}\n\n\t\t// Handle numeric array index\n\t\tif (/^\\d+$/.test(segment)) {\n\t\t\tconst index = Number.parseInt(segment, 10);\n\t\t\tcurrent = current[index];\n\t\t} else {\n\t\t\tcurrent = current[segment];\n\t\t}\n\t}\n\n\treturn current;\n}\n\n/**\n * Deep equality check\n */\nfunction deepEqual(a: any, b: any): boolean {\n\tif (a === b) return true;\n\n\tif (typeof a !== typeof b) return false;\n\n\tif (typeof a !== \"object\" || a === null || b === null) {\n\t\treturn a === b;\n\t}\n\n\tif (Array.isArray(a) !== Array.isArray(b)) return false;\n\n\tif (Array.isArray(a)) {\n\t\tif (a.length !== b.length) return false;\n\t\treturn a.every((val, idx) => deepEqual(val, b[idx]));\n\t}\n\n\tconst keysA = Object.keys(a);\n\tconst keysB = Object.keys(b);\n\n\tif (keysA.length !== keysB.length) return false;\n\n\treturn keysA.every((key) => deepEqual(a[key], b[key]));\n}\n\n/**\n * Check if value at JSON path matches expected value\n *\n * @param response - MCP response (tool, prompt, or resource)\n * @param path - JSON path expression\n * @param expected - Expected value at path (optional - if omitted, checks path existence)\n * @returns Assertion result\n */\nexport async function checkJsonPath(\n\tresponse: MCPResponse,\n\tpath: string,\n\texpected?: any,\n): Promise<AssertionResult> {\n\ttry {\n\t\tlet responseData: any;\n\n\t\t// For prompts and resources, use the response object directly\n\t\t// For tools, parse the text content as JSON\n\t\tif (\"messages\" in response) {\n\t\t\t// Prompt response - use the response object directly\n\t\t\tresponseData = response;\n\t\t} else if (\"contents\" in response && Array.isArray(response.contents)) {\n\t\t\t// Resource response - use the response object directly\n\t\t\tresponseData = response;\n\t\t} else if (\"content\" in response && Array.isArray(response.content)) {\n\t\t\t// Tool response - try to parse the text content as JSON\n\t\t\tconst responseText = getResponseText(response);\n\t\t\ttry {\n\t\t\t\tresponseData = JSON.parse(responseText);\n\t\t\t} catch {\n\t\t\t\treturn {\n\t\t\t\t\ttype: \"json_path\",\n\t\t\t\t\tpassed: false,\n\t\t\t\t\tmessage: \"Response is not valid JSON\",\n\t\t\t\t\texpected: \"valid JSON\",\n\t\t\t\t\tactual: \"invalid JSON\",\n\t\t\t\t};\n\t\t\t}\n\t\t} else {\n\t\t\treturn {\n\t\t\t\ttype: \"json_path\",\n\t\t\t\tpassed: false,\n\t\t\t\tmessage: \"Unknown response type\",\n\t\t\t\texpected: \"valid MCP response\",\n\t\t\t\tactual: \"unknown type\",\n\t\t\t};\n\t\t}\n\n\t\t// Evaluate path\n\t\tconst actual = evaluateJsonPath(responseData, path);\n\n\t\t// If expected is undefined, check path existence\n\t\tif (expected === undefined) {\n\t\t\tconst exists = actual !== undefined;\n\t\t\treturn {\n\t\t\t\ttype: \"json_path\",\n\t\t\t\tpassed: exists,\n\t\t\t\tmessage: exists\n\t\t\t\t\t? `Path \"${path}\" exists with value: ${JSON.stringify(actual)}`\n\t\t\t\t\t: `Path \"${path}\" does not exist in response`,\n\t\t\t\tactual: exists ? actual : undefined,\n\t\t\t};\n\t\t}\n\n\t\t// Compare with expected value\n\t\tconst matches = deepEqual(actual, expected);\n\n\t\tif (!matches) {\n\t\t\t// Provide helpful type mismatch hints\n\t\t\tconst actualType = typeof actual;\n\t\t\tconst expectedType = typeof expected;\n\t\t\tconst typeHint =\n\t\t\t\tactualType !== expectedType\n\t\t\t\t\t? ` (type mismatch: ${actualType} vs ${expectedType})`\n\t\t\t\t\t: \"\";\n\n\t\t\treturn {\n\t\t\t\ttype: \"json_path\",\n\t\t\t\tpassed: false,\n\t\t\t\tmessage: `Value at path \"${path}\" does not match expected${typeHint}`,\n\t\t\t\texpected,\n\t\t\t\tactual,\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\ttype: \"json_path\",\n\t\t\tpassed: true,\n\t\t\tmessage: `Value at path \"${path}\" matches expected value`,\n\t\t\texpected,\n\t\t\tactual,\n\t\t};\n\t} catch (error) {\n\t\treturn {\n\t\t\ttype: \"json_path\",\n\t\t\tpassed: false,\n\t\t\tmessage: error instanceof Error ? error.message : String(error),\n\t\t};\n\t}\n}\n","/**\n * Regex Match Assertion\n *\n * Verifies that response matches a regular expression pattern.\n */\n\nimport type { MCPToolResponse } from \"../types/client.js\";\nimport type { AssertionResult } from \"../types/results.js\";\nimport { getResponseText } from \"./helpers.js\";\n\n/**\n * Check if response matches regex pattern\n *\n * @param response - MCP tool response\n * @param pattern - Regex pattern string\n * @param flags - Regex flags (e.g., \"i\" for case-insensitive)\n * @returns Assertion result\n */\nexport function checkRegexMatch(\n\tresponse: MCPToolResponse,\n\tpattern: string,\n\tflags?: string,\n): AssertionResult {\n\tconst responseText = getResponseText(response);\n\n\ttry {\n\t\tconst regex = new RegExp(pattern, flags);\n\t\tconst matches = regex.test(responseText);\n\n\t\tif (!matches) {\n\t\t\treturn {\n\t\t\t\ttype: \"regex_match\",\n\t\t\t\tpassed: false,\n\t\t\t\tmessage: `Response does not match pattern: ${pattern}`,\n\t\t\t\texpected: `text matching /${pattern}/${flags || \"\"}`,\n\t\t\t\tactual: responseText.substring(0, 200), // First 200 chars\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\ttype: \"regex_match\",\n\t\t\tpassed: true,\n\t\t\tmessage: `Response matches pattern: ${pattern}`,\n\t\t};\n\t} catch (error) {\n\t\treturn {\n\t\t\ttype: \"regex_match\",\n\t\t\tpassed: false,\n\t\t\tmessage: `Invalid regex pattern: ${error instanceof Error ? error.message : String(error)}`,\n\t\t};\n\t}\n}\n","/**\n * Assertion Engine\n *\n * Runs assertions against MCP tool responses.\n *\n * Design: Fully portable, no project-specific dependencies\n */\n\nimport type { Assertion } from \"../types/spec.js\";\nimport type { AssertionResult } from \"../types/results.js\";\nimport type { MCPToolResponse } from \"../types/client.js\";\nimport { checkSuccess } from \"./success.js\";\nimport { checkError } from \"./error.js\";\nimport { checkContainsText, checkNotContainsText } from \"./contains-text.js\";\nimport { checkResponseTime } from \"./response-time.js\";\nimport { checkJsonPath } from \"./json-path.js\";\nimport { checkRegexMatch } from \"./regex.js\";\n\n/**\n * Run all assertions against a tool response\n *\n * @param assertions - List of assertions to run\n * @param response - MCP tool response\n * @param duration - Response time in milliseconds\n * @returns Array of assertion results\n */\nexport async function runAssertions(\n\tassertions: Assertion[],\n\tresponse: MCPToolResponse,\n\tduration: number,\n): Promise<AssertionResult[]> {\n\tconst results: AssertionResult[] = [];\n\n\tfor (const assertion of assertions) {\n\t\tlet result: AssertionResult;\n\n\t\ttry {\n\t\t\tswitch (assertion.type) {\n\t\t\t\tcase \"success\":\n\t\t\t\t\tresult = checkSuccess(response);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"error\":\n\t\t\t\t\tresult = checkError(response, assertion.messageContains);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"contains_text\":\n\t\t\t\t\tresult = checkContainsText(response, assertion.text, assertion.caseInsensitive);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"not_contains_text\":\n\t\t\t\t\tresult = checkNotContainsText(response, assertion.text, assertion.caseInsensitive);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"response_time_ms\":\n\t\t\t\t\tresult = checkResponseTime(duration, assertion.max);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"json_path\":\n\t\t\t\t\tresult = await checkJsonPath(response, assertion.path, assertion.expected);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"regex_match\":\n\t\t\t\t\tresult = checkRegexMatch(response, assertion.pattern, assertion.flags);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"snapshot\":\n\t\t\t\t\t// Snapshot assertions are handled separately (require file system access)\n\t\t\t\t\tresult = {\n\t\t\t\t\t\ttype: \"snapshot\",\n\t\t\t\t\t\tpassed: false,\n\t\t\t\t\t\tmessage: \"Snapshot assertions not yet implemented in this context\",\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"json_schema\":\n\t\t\t\t\t// JSON Schema assertions are handled separately (require file system access)\n\t\t\t\t\tresult = {\n\t\t\t\t\t\ttype: \"json_schema\",\n\t\t\t\t\t\tpassed: false,\n\t\t\t\t\t\tmessage: \"JSON Schema assertions not yet implemented in this context\",\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tresult = {\n\t\t\t\t\t\ttype: \"unknown\",\n\t\t\t\t\t\tpassed: false,\n\t\t\t\t\t\tmessage: `Unknown assertion type: ${(assertion as any).type}`,\n\t\t\t\t\t};\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tresult = {\n\t\t\t\ttype: assertion.type,\n\t\t\t\tpassed: false,\n\t\t\t\tmessage: error instanceof Error ? error.message : String(error),\n\t\t\t};\n\t\t}\n\n\t\tresults.push(result);\n\t}\n\n\treturn results;\n}\n\n// Export individual assertion functions (for testing)\nexport { checkSuccess } from \"./success.js\";\nexport { checkError } from \"./error.js\";\nexport { checkContainsText, checkNotContainsText } from \"./contains-text.js\";\nexport { checkResponseTime } from \"./response-time.js\";\nexport { checkJsonPath } from \"./json-path.js\";\nexport { checkRegexMatch } from \"./regex.js\";\n\n// Export helper functions\nexport { getResponseText } from \"./helpers.js\";\n","/**\n * Core Test Runner\n *\n * Executes test specifications against an MCP server.\n *\n * Design: Fully portable, uses IMCPTestClient interface\n */\n\nimport type { IMCPTestClient } from \"./types/client.js\";\nimport type { TestSpec } from \"./types/spec.js\";\nimport type { TestResult, TestRunResults, TestSummary } from \"./types/results.js\";\nimport { runAssertions } from \"./assertions/index.js\";\n\n/**\n * Test Runner\n *\n * Executes tests using the provided MCP client.\n */\nexport class TestRunner {\n\tconstructor(private client: IMCPTestClient) {}\n\n\t/**\n\t * Run a single test specification\n\t *\n\t * @param spec - Test specification to run\n\t * @returns Test result\n\t */\n\tasync runTest(spec: TestSpec): Promise<TestResult> {\n\t\t// Handle skipped tests\n\t\tif (spec.skip) {\n\t\t\treturn {\n\t\t\t\tname: spec.name,\n\t\t\t\tdescription: spec.description,\n\t\t\t\tpassed: false,\n\t\t\t\tduration: 0,\n\t\t\t\tassertions: [],\n\t\t\t\tskipped: true,\n\t\t\t};\n\t\t}\n\n\t\tconst startTime = Date.now();\n\n\t\ttry {\n\t\t\t// Dispatch based on test type\n\t\t\tlet response: any;\n\n\t\t\tswitch (spec.type) {\n\t\t\t\tcase \"tool\":\n\t\t\t\t\t// Execute tool test\n\t\t\t\t\tresponse = await this.client.callTool(spec.tool, spec.arguments);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"prompt\":\n\t\t\t\t\t// Execute prompt test\n\t\t\t\t\tresponse = await this.client.getPrompt(spec.prompt, spec.arguments);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"resource\":\n\t\t\t\t\t// Execute resource test\n\t\t\t\t\tresponse = await this.client.readResource(spec.uri);\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\t// TypeScript should ensure this is never reached\n\t\t\t\t\t// But provide fallback for safety\n\t\t\t\t\tthrow new Error(`Unknown test type: ${(spec as any).type}`);\n\t\t\t}\n\n\t\t\tconst duration = Date.now() - startTime;\n\n\t\t\t// Run assertions\n\t\t\tconst assertionResults = await runAssertions(spec.assertions, response, duration);\n\n\t\t\t// Determine if test passed (all assertions must pass)\n\t\t\tconst passed = assertionResults.every((a) => a.passed);\n\n\t\t\treturn {\n\t\t\t\tname: spec.name,\n\t\t\t\tdescription: spec.description,\n\t\t\t\tpassed,\n\t\t\t\tduration,\n\t\t\t\tassertions: assertionResults,\n\t\t\t};\n\t\t} catch (error) {\n\t\t\tconst duration = Date.now() - startTime;\n\n\t\t\treturn {\n\t\t\t\tname: spec.name,\n\t\t\t\tdescription: spec.description,\n\t\t\t\tpassed: false,\n\t\t\t\tduration,\n\t\t\t\tassertions: [],\n\t\t\t\terror: {\n\t\t\t\t\tmessage: error instanceof Error ? error.message : String(error),\n\t\t\t\t\tstack: error instanceof Error ? error.stack : undefined,\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\t}\n\n\t/**\n\t * Run multiple test specifications\n\t *\n\t * @param specs - Array of test specifications\n\t * @param serverUrl - Server URL being tested (for reporting)\n\t * @returns Complete test run results\n\t */\n\tasync runTests(specs: TestSpec[], serverUrl?: string): Promise<TestRunResults> {\n\t\tconst startTime = Date.now();\n\t\tconst results: TestResult[] = [];\n\n\t\t// Check for \"only\" tests\n\t\tconst onlyTests = specs.filter((s) => s.only);\n\t\tconst testsToRun = onlyTests.length > 0 ? onlyTests : specs;\n\n\t\t// Run each test\n\t\tfor (const spec of testsToRun) {\n\t\t\tconst result = await this.runTest(spec);\n\t\t\tresults.push(result);\n\t\t}\n\n\t\tconst totalDuration = Date.now() - startTime;\n\n\t\t// Build summary\n\t\tconst summary: TestSummary = {\n\t\t\ttotal: results.length,\n\t\t\tpassed: results.filter((r) => r.passed).length,\n\t\t\tfailed: results.filter((r) => !r.passed && !r.skipped).length,\n\t\t\tskipped: results.filter((r) => r.skipped).length,\n\t\t\tduration: totalDuration,\n\t\t\tsuccessRate: results.length > 0 ? results.filter((r) => r.passed).length / results.length : 0,\n\t\t};\n\n\t\t// Collect failures\n\t\tconst failures = results\n\t\t\t.filter((r) => !r.passed && !r.skipped)\n\t\t\t.flatMap((r) => {\n\t\t\t\t// If test had an error\n\t\t\t\tif (r.error) {\n\t\t\t\t\treturn [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttest: r.name,\n\t\t\t\t\t\t\tassertion: \"execution\",\n\t\t\t\t\t\t\texpected: \"successful execution\",\n\t\t\t\t\t\t\tactual: \"error\",\n\t\t\t\t\t\t\tmessage: r.error.message,\n\t\t\t\t\t\t},\n\t\t\t\t\t];\n\t\t\t\t}\n\n\t\t\t\t// Failed assertions\n\t\t\t\treturn r.assertions\n\t\t\t\t\t.filter((a) => !a.passed)\n\t\t\t\t\t.map((a) => ({\n\t\t\t\t\t\ttest: r.name,\n\t\t\t\t\t\tassertion: a.type,\n\t\t\t\t\t\texpected: a.expected,\n\t\t\t\t\t\tactual: a.actual,\n\t\t\t\t\t\tmessage: a.message || \"Assertion failed\",\n\t\t\t\t\t}));\n\t\t\t});\n\n\t\treturn {\n\t\t\tsummary,\n\t\t\ttests: results,\n\t\t\tfailures,\n\t\t\ttimestamp: new Date().toISOString(),\n\t\t\tserverUrl,\n\t\t};\n\t}\n\n\t/**\n\t * Connect to the MCP server\n\t *\n\t * Must be called before running tests.\n\t */\n\tasync connect(): Promise<void> {\n\t\tawait this.client.connect();\n\t}\n\n\t/**\n\t * Disconnect from the MCP server\n\t *\n\t * Should be called after tests complete.\n\t */\n\tasync disconnect(): Promise<void> {\n\t\tawait this.client.disconnect();\n\t}\n}\n","/**\n * Zod Validation Schemas\n *\n * Validates test specifications loaded from YAML/JSON files.\n *\n * Design: Fully portable, uses Zod for runtime validation\n */\n\nimport { z } from \"zod\";\n\n/**\n * Assertion schemas\n */\nconst SuccessAssertionSchema = z.object({\n\ttype: z.literal(\"success\"),\n});\n\nconst ErrorAssertionSchema = z.object({\n\ttype: z.literal(\"error\"),\n\tmessageContains: z.string().optional(),\n});\n\nconst ContainsTextAssertionSchema = z.object({\n\ttype: z.literal(\"contains_text\"),\n\ttext: z.string(),\n\tcaseInsensitive: z.boolean().optional(),\n});\n\nconst NotContainsTextAssertionSchema = z.object({\n\ttype: z.literal(\"not_contains_text\"),\n\ttext: z.string(),\n\tcaseInsensitive: z.boolean().optional(),\n});\n\nconst ResponseTimeAssertionSchema = z.object({\n\ttype: z.literal(\"response_time_ms\"),\n\tmax: z.number().positive(),\n});\n\nconst JsonPathAssertionSchema = z.object({\n\ttype: z.literal(\"json_path\"),\n\tpath: z.string(),\n\texpected: z.any().optional(),\n});\n\nconst RegexMatchAssertionSchema = z.object({\n\ttype: z.literal(\"regex_match\"),\n\tpattern: z.string(),\n\tflags: z.string().optional(),\n});\n\nconst SnapshotAssertionSchema = z.object({\n\ttype: z.literal(\"snapshot\"),\n\tfile: z.string(),\n\tignoreFields: z.array(z.string()).optional(),\n});\n\nconst JsonSchemaAssertionSchema = z.object({\n\ttype: z.literal(\"json_schema\"),\n\tschema: z.string(),\n});\n\n/**\n * Union of all assertion types\n */\nexport const AssertionSchema = z.discriminatedUnion(\"type\", [\n\tSuccessAssertionSchema,\n\tErrorAssertionSchema,\n\tContainsTextAssertionSchema,\n\tNotContainsTextAssertionSchema,\n\tResponseTimeAssertionSchema,\n\tJsonPathAssertionSchema,\n\tRegexMatchAssertionSchema,\n\tSnapshotAssertionSchema,\n\tJsonSchemaAssertionSchema,\n]);\n\n/**\n * Base test specification schema (shared fields)\n */\nconst BaseTestSpecSchema = z.object({\n\tname: z.string().min(1, \"Test name is required\"),\n\tdescription: z.string().optional(),\n\tassertions: z.array(AssertionSchema).min(1, \"At least one assertion required\"),\n\ttimeout: z.number().positive().optional(),\n\tskip: z.boolean().optional(),\n\tonly: z.boolean().optional(),\n});\n\n/**\n * Tool test specification schema\n */\nconst ToolTestSpecSchema = BaseTestSpecSchema.extend({\n\ttype: z.literal(\"tool\"),\n\ttool: z.string().min(1, \"Tool name is required\"),\n\targuments: z.record(z.any()),\n});\n\n/**\n * Prompt test specification schema\n */\nconst PromptTestSpecSchema = BaseTestSpecSchema.extend({\n\ttype: z.literal(\"prompt\"),\n\tprompt: z.string().min(1, \"Prompt name is required\"),\n\targuments: z.record(z.any()).optional(),\n});\n\n/**\n * Resource test specification schema\n */\nconst ResourceTestSpecSchema = BaseTestSpecSchema.extend({\n\ttype: z.literal(\"resource\"),\n\turi: z.string().min(1, \"Resource URI is required\"),\n});\n\n/**\n * Test specification schema (discriminated union)\n */\nconst TestSpecUnionSchema = z.discriminatedUnion(\"type\", [\n\tToolTestSpecSchema,\n\tPromptTestSpecSchema,\n\tResourceTestSpecSchema,\n]);\n\n/**\n * Test specification schema with backward compatibility\n *\n * Handles old test specs without a 'type' field by treating them as tool tests.\n */\nexport const TestSpecSchema = z.preprocess(\n\t(data) => {\n\t\t// If data has a 'type' field, use it as-is\n\t\tif (typeof data === \"object\" && data !== null && \"type\" in data) {\n\t\t\treturn data;\n\t\t}\n\n\t\t// If data has a 'tool' field but no 'type', it's a legacy tool test\n\t\tif (typeof data === \"object\" && data !== null && \"tool\" in data) {\n\t\t\treturn { ...data, type: \"tool\" };\n\t\t}\n\n\t\t// Otherwise, pass through and let validation fail with helpful message\n\t\treturn data;\n\t},\n\tTestSpecUnionSchema,\n);\n\n/**\n * Test suite specification schema\n */\nexport const TestSuiteSpecSchema = z.object({\n\tname: z.string().min(1, \"Suite name is required\"),\n\tdescription: z.string().optional(),\n\ttests: z.array(z.union([z.string(), TestSpecSchema])),\n\tsetup: z\n\t\t.object({\n\t\t\tserverUrl: z.string().url().optional(),\n\t\t})\n\t\t.optional(),\n});\n\n/**\n * Validate a test spec object\n *\n * @param data - Raw data to validate\n * @returns Validated TestSpec\n * @throws ZodError if validation fails\n */\nexport function validateTestSpec(data: unknown) {\n\treturn TestSpecSchema.parse(data);\n}\n\n/**\n * Validate a test suite spec object\n *\n * @param data - Raw data to validate\n * @returns Validated TestSuiteSpec\n * @throws ZodError if validation fails\n */\nexport function validateTestSuiteSpec(data: unknown) {\n\treturn TestSuiteSpecSchema.parse(data);\n}\n\n/**\n * Safe validation that returns success/error\n */\nexport function safeValidateTestSpec(data: unknown) {\n\treturn TestSpecSchema.safeParse(data);\n}\n\nexport function safeValidateTestSuiteSpec(data: unknown) {\n\treturn TestSuiteSpecSchema.safeParse(data);\n}\n","/**\n * Test Specification Loader\n *\n * Loads and validates test specifications from YAML or JSON files.\n *\n * Design: Fully portable, no project-specific dependencies\n */\n\nimport { readFile } from \"node:fs/promises\";\nimport { extname } from \"node:path\";\nimport { parse as parseYAML, stringify as stringifyYAML } from \"yaml\";\nimport { validateTestSpec, validateTestSuiteSpec } from \"./validation/schemas.js\";\nimport type { TestSpec, TestSuiteSpec } from \"./types/spec.js\";\n\n/**\n * Load a test specification from a file\n *\n * Supports both YAML (.yaml, .yml) and JSON (.json) formats.\n *\n * @param filePath - Path to test spec file\n * @returns Validated TestSpec\n * @throws Error if file cannot be read or validation fails\n */\nexport async function loadTestSpec(filePath: string): Promise<TestSpec> {\n\tconst content = await readFile(filePath, \"utf-8\");\n\tconst ext = extname(filePath).toLowerCase();\n\n\tlet data: unknown;\n\n\tif (ext === \".yaml\" || ext === \".yml\") {\n\t\tdata = parseYAML(content);\n\t} else if (ext === \".json\") {\n\t\tdata = JSON.parse(content);\n\t} else {\n\t\tthrow new Error(`Unsupported file format: ${ext}. Use .yaml, .yml, or .json`);\n\t}\n\n\ttry {\n\t\treturn validateTestSpec(data);\n\t} catch (error) {\n\t\tif (error instanceof Error) {\n\t\t\tthrow new Error(`Invalid test spec in ${filePath}: ${error.message}`);\n\t\t}\n\t\tthrow error;\n\t}\n}\n\n/**\n * Load a test suite specification from a file\n *\n * @param filePath - Path to test suite spec file\n * @returns Validated TestSuiteSpec\n * @throws Error if file cannot be read or validation fails\n */\nexport async function loadTestSuiteSpec(filePath: string): Promise<TestSuiteSpec> {\n\tconst content = await readFile(filePath, \"utf-8\");\n\tconst ext = extname(filePath).toLowerCase();\n\n\tlet data: unknown;\n\n\tif (ext === \".yaml\" || ext === \".yml\") {\n\t\tdata = parseYAML(content);\n\t} else if (ext === \".json\") {\n\t\tdata = JSON.parse(content);\n\t} else {\n\t\tthrow new Error(`Unsupported file format: ${ext}. Use .yaml, .yml, or .json`);\n\t}\n\n\ttry {\n\t\treturn validateTestSuiteSpec(data);\n\t} catch (error) {\n\t\tif (error instanceof Error) {\n\t\t\tthrow new Error(`Invalid test suite spec in ${filePath}: ${error.message}`);\n\t\t}\n\t\tthrow error;\n\t}\n}\n\n/**\n * Parse a test spec from a string\n *\n * Useful for programmatic test generation.\n *\n * @param content - YAML or JSON string\n * @param format - Format of the content ('yaml' or 'json')\n * @returns Validated TestSpec\n */\nexport function parseTestSpec(content: string, format: \"yaml\" | \"json\"): TestSpec {\n\tlet data: unknown;\n\n\tif (format === \"yaml\") {\n\t\tdata = parseYAML(content);\n\t} else {\n\t\tdata = JSON.parse(content);\n\t}\n\n\treturn validateTestSpec(data);\n}\n\n/**\n * Serialize a test spec to YAML string\n *\n * @param spec - TestSpec object\n * @returns YAML string\n */\nexport function serializeTestSpecToYAML(spec: TestSpec): string {\n\treturn stringifyYAML(spec);\n}\n\n/**\n * Serialize a test spec to JSON string\n *\n * @param spec - TestSpec object\n * @param pretty - Pretty print (default: true)\n * @returns JSON string\n */\nexport function serializeTestSpecToJSON(spec: TestSpec, pretty = true): string {\n\treturn pretty ? JSON.stringify(spec, null, 2) : JSON.stringify(spec);\n}\n","/**\n * JSON Reporter\n *\n * Outputs test results in machine-parseable JSON format.\n *\n * Design: Fully portable, optimized for agent consumption\n */\n\nimport type { TestRunResults } from \"../types/results.js\";\n\n/**\n * Format test results as JSON\n *\n * @param results - Test run results\n * @param pretty - Pretty print (default: true)\n * @returns JSON string\n */\nexport function formatAsJSON(results: TestRunResults, pretty = true): string {\n\treturn pretty ? JSON.stringify(results, null, 2) : JSON.stringify(results);\n}\n\n/**\n * Print test results as JSON to console\n *\n * @param results - Test run results\n * @param pretty - Pretty print (default: true)\n */\nexport function printJSON(results: TestRunResults, pretty = true): void {\n\tconsole.log(formatAsJSON(results, pretty));\n}\n\n/**\n * Get a simple pass/fail summary for agents\n *\n * Returns minimal JSON for quick checks.\n *\n * @param results - Test run results\n * @returns Simplified JSON string\n */\nexport function formatSimpleSummary(results: TestRunResults): string {\n\tconst summary = {\n\t\tpassed: results.summary.passed === results.summary.total,\n\t\ttotal: results.summary.total,\n\t\tpassed_count: results.summary.passed,\n\t\tfailed_count: results.summary.failed,\n\t\tduration_ms: results.summary.duration,\n\t\tsuccess_rate: results.summary.successRate,\n\t};\n\n\treturn JSON.stringify(summary, null, 2);\n}\n","/**\n * Console Reporter\n *\n * Outputs human-readable test results to console.\n *\n * Design: Fully portable, colorized console output\n */\n\nimport type { TestRunResults, TestResult } from \"../types/results.js\";\n\n// ANSI color codes\nconst colors = {\n\treset: \"\\x1b[0m\",\n\tgreen: \"\\x1b[32m\",\n\tred: \"\\x1b[31m\",\n\tyellow: \"\\x1b[33m\",\n\tblue: \"\\x1b[34m\",\n\tgray: \"\\x1b[90m\",\n\tbold: \"\\x1b[1m\",\n};\n\n/**\n * Print a single test result\n */\nfunction printTestResult(test: TestResult, index: number): void {\n\tconst status = test.skipped\n\t\t? `${colors.yellow}SKIP${colors.reset}`\n\t\t: test.passed\n\t\t\t? `${colors.green}PASS${colors.reset}`\n\t\t\t: `${colors.red}FAIL${colors.reset}`;\n\n\tconst duration = `${colors.gray}${test.duration}ms${colors.reset}`;\n\n\tconsole.log(`  ${status} ${test.name} ${duration}`);\n\n\t// Show failed assertions\n\tif (!test.passed && !test.skipped) {\n\t\tif (test.error) {\n\t\t\tconsole.log(`    ${colors.red}${colors.reset} ${test.error.message}`);\n\t\t} else {\n\t\t\tfor (const assertion of test.assertions) {\n\t\t\t\tif (!assertion.passed) {\n\t\t\t\t\tconsole.log(`    ${colors.red}${colors.reset} ${assertion.type}: ${assertion.message}`);\n\t\t\t\t\tif (assertion.expected !== undefined) {\n\t\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\t`      Expected: ${colors.gray}${JSON.stringify(assertion.expected)}${colors.reset}`,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\t`      Actual:   ${colors.gray}${JSON.stringify(assertion.actual)}${colors.reset}`,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Print test run summary\n */\nfunction printSummary(results: TestRunResults): void {\n\tconsole.log(\"\");\n\tconsole.log(`${colors.bold}Test Summary${colors.reset}`);\n\tconsole.log(`${colors.gray}${\"\".repeat(50)}${colors.reset}`);\n\n\tconst passed = results.summary.passed;\n\tconst failed = results.summary.failed;\n\tconst skipped = results.summary.skipped;\n\tconst total = results.summary.total;\n\n\tconsole.log(`Total:   ${total}`);\n\tconsole.log(`${colors.green}Passed:  ${passed}${colors.reset}`);\n\n\tif (failed > 0) {\n\t\tconsole.log(`${colors.red}Failed:  ${failed}${colors.reset}`);\n\t}\n\n\tif (skipped > 0) {\n\t\tconsole.log(`${colors.yellow}Skipped: ${skipped}${colors.reset}`);\n\t}\n\n\tconsole.log(`Duration: ${results.summary.duration}ms`);\n\tconsole.log(`Success Rate: ${(results.summary.successRate * 100).toFixed(1)}%`);\n\tconsole.log(\"\");\n}\n\n/**\n * Print full test results in human-readable format\n *\n * @param results - Test run results\n */\nexport function printConsole(results: TestRunResults): void {\n\tconsole.log(\"\");\n\tconsole.log(`${colors.bold}Running Integration Tests${colors.reset}`);\n\n\tif (results.serverUrl) {\n\t\tconsole.log(`${colors.gray}Server: ${results.serverUrl}${colors.reset}`);\n\t}\n\n\tconsole.log(`${colors.gray}Timestamp: ${results.timestamp}${colors.reset}`);\n\tconsole.log(\"\");\n\n\t// Print each test result\n\tresults.tests.forEach((test, index) => {\n\t\tprintTestResult(test, index);\n\t});\n\n\t// Print summary\n\tprintSummary(results);\n\n\t// Print failures in detail\n\tif (results.failures.length > 0) {\n\t\tconsole.log(`${colors.bold}${colors.red}Failures:${colors.reset}`);\n\t\tconsole.log(`${colors.gray}${\"\".repeat(50)}${colors.reset}`);\n\n\t\tfor (const failure of results.failures) {\n\t\t\tconsole.log(`${colors.red}${colors.reset} ${failure.test}`);\n\t\t\tconsole.log(`  Assertion: ${failure.assertion}`);\n\t\t\tconsole.log(`  Message: ${failure.message}`);\n\n\t\t\tif (failure.expected !== undefined) {\n\t\t\t\tconsole.log(`  Expected: ${JSON.stringify(failure.expected)}`);\n\t\t\t\tconsole.log(`  Actual: ${JSON.stringify(failure.actual)}`);\n\t\t\t}\n\n\t\t\tconsole.log(\"\");\n\t\t}\n\t}\n}\n\n/**\n * Print a simple pass/fail message\n *\n * @param results - Test run results\n */\nexport function printSimple(results: TestRunResults): void {\n\tconst allPassed = results.summary.failed === 0;\n\n\tif (allPassed) {\n\t\tconsole.log(\n\t\t\t`${colors.green}${colors.bold} All tests passed${colors.reset} (${results.summary.passed}/${results.summary.total})`,\n\t\t);\n\t} else {\n\t\tconsole.log(\n\t\t\t`${colors.red}${colors.bold} Tests failed${colors.reset} (${results.summary.failed} failed, ${results.summary.passed} passed)`,\n\t\t);\n\t}\n}\n","/**\n * Zod Validation Schemas for Template System\n *\n * Runtime validation for template configurations.\n */\n\nimport { z } from \"zod\";\n\n/**\n * Template variable schema\n */\nexport const TemplateVariableSchema = z.object({\n\tname: z\n\t\t.string()\n\t\t.min(1)\n\t\t.regex(/^[A-Z][A-Z0-9_]*$/, \"Variable name must be uppercase with underscores\"),\n\trequired: z.boolean(),\n\tdefault: z.string().optional(),\n\tprompt: z.string().optional(),\n\tpattern: z.string().optional(),\n});\n\n/**\n * Post-scaffold configuration schema\n */\nexport const PostScaffoldConfigSchema = z.object({\n\tinstall: z.boolean(),\n\tinstallCommand: z.string().optional(),\n\tpostInstall: z.array(z.string()).optional(),\n\tsmokeTest: z.string().optional(),\n});\n\n/**\n * Template capabilities schema\n */\nexport const TemplateCapabilitiesSchema = z.object({\n\truntime: z.string().min(1),\n\ttransport: z.array(z.string().min(1)).min(1),\n\tdeployment: z.enum([\"remote\", \"local\"]),\n\tlanguage: z.enum([\"typescript\", \"javascript\"]),\n});\n\n/**\n * Template dependencies schema\n */\nexport const TemplateDependenciesSchema = z.object({\n\tmcp_sdk: z.string().optional(),\n\tagents: z.string().optional(),\n\truntime_specific: z.record(z.string()).optional(),\n});\n\n/**\n * CLI commands schema\n */\nexport const TemplateCLICommandsSchema = z.object({\n\tdev: z.string().min(1),\n\ttest: z.string().min(1),\n\tdeploy: z.string().optional(),\n\ttypeCheck: z.string().optional(),\n});\n\n/**\n * Template features schema\n */\nexport const TemplateFeaturesSchema = z.object({\n\tunitTesting: z.boolean(),\n\tintegrationTesting: z.boolean(),\n\texampleTools: z.array(z.string()),\n\tdocumentation: z.boolean(),\n});\n\n/**\n * Compatibility requirements schema\n */\nexport const TemplateCompatibilitySchema = z.object({\n\tnode: z.string().optional(),\n\tnpm: z.string().optional(),\n\tpnpm: z.string().optional(),\n\tyarn: z.string().optional(),\n});\n\n/**\n * Complete template configuration schema\n */\nexport const TemplateConfigSchema = z.object({\n\tid: z\n\t\t.string()\n\t\t.min(1)\n\t\t.regex(/^[a-z0-9-]+$/, \"Template ID must be lowercase with hyphens\"),\n\tversion: z.string().regex(/^\\d+\\.\\d+\\.\\d+$/, \"Version must be semver (e.g., 1.0.0)\"),\n\tname: z.string().min(1),\n\tdescription: z.string().min(1),\n\tcapabilities: TemplateCapabilitiesSchema,\n\tdependencies: TemplateDependenciesSchema,\n\tscaffolding: z.object({\n\t\tvariables: z.array(TemplateVariableSchema),\n\t\tpostScaffold: PostScaffoldConfigSchema.optional(),\n\t}),\n\tcli: TemplateCLICommandsSchema,\n\tfeatures: TemplateFeaturesSchema,\n\tcompatibility: TemplateCompatibilitySchema,\n});\n\n/**\n * Scaffold metadata schema\n */\nexport const ScaffoldMetadataSchema = z.object({\n\tid: z.string(),\n\tversion: z.string(),\n\tname: z.string(),\n\tmcp_sdk_version: z.string().optional(),\n\tagents_version: z.string().optional(),\n\tscaffolded_at: z.string(),\n\tvariables: z.record(z.string()),\n});\n\n/**\n * Scaffold options schema\n */\nexport const ScaffoldOptionsSchema = z.object({\n\ttemplate: z.string().min(1),\n\ttargetDir: z.string().min(1),\n\tvariables: z.record(z.string()),\n\tnoInstall: z.boolean().optional(),\n\tpackageManager: z.enum([\"npm\", \"pnpm\", \"yarn\", \"bun\"]).optional(),\n\tsmokeTest: z.boolean().optional(),\n});\n\n/**\n * Template filter schema\n */\nexport const TemplateFilterSchema = z.object({\n\truntime: z.string().optional(),\n\ttransport: z.string().optional(),\n\tdeployment: z.enum([\"remote\", \"local\"]).optional(),\n\tlanguage: z.enum([\"typescript\", \"javascript\"]).optional(),\n});\n\n/**\n * Validation helper: Parse and validate template config\n */\nexport function validateTemplateConfig(config: unknown): {\n\tsuccess: boolean;\n\tdata?: z.infer<typeof TemplateConfigSchema>;\n\terrors?: z.ZodError;\n} {\n\tconst result = TemplateConfigSchema.safeParse(config);\n\n\tif (result.success) {\n\t\treturn { success: true, data: result.data };\n\t}\n\n\treturn { success: false, errors: result.error };\n}\n\n/**\n * Validation helper: Parse and validate scaffold options\n */\nexport function validateScaffoldOptions(options: unknown): {\n\tsuccess: boolean;\n\tdata?: z.infer<typeof ScaffoldOptionsSchema>;\n\terrors?: z.ZodError;\n} {\n\tconst result = ScaffoldOptionsSchema.safeParse(options);\n\n\tif (result.success) {\n\t\treturn { success: true, data: result.data };\n\t}\n\n\treturn { success: false, errors: result.error };\n}\n","/**\n * Template Registry\n *\n * Discovers, validates, and manages templates.\n */\n\nimport { readdir, readFile, access } from \"node:fs/promises\";\nimport { join, dirname } from \"node:path\";\nimport { fileURLToPath } from \"node:url\";\nimport type {\n\tTemplate,\n\tTemplateConfig,\n\tTemplateFilter,\n\tTemplateValidationResult,\n} from \"./types.js\";\nimport { validateTemplateConfig } from \"./schemas.js\";\n\n/**\n * Get the templates directory path\n * Works both in development and when installed as a package\n */\nfunction getTemplatesDir(): string {\n\tconst __filename = fileURLToPath(import.meta.url);\n\tconst __dirname = dirname(__filename);\n\n\t// Check if we're running from src/ or dist/\n\tif (__dirname.includes(\"/src/\")) {\n\t\t// Running from source (tests): src/core/template-system -> ../../../templates\n\t\treturn join(__dirname, \"../../../templates\");\n\t} else {\n\t\t// Running from dist (CLI): dist/ -> ../templates\n\t\treturn join(__dirname, \"../templates\");\n\t}\n}\n\n/**\n * Template Registry - discovers and validates templates\n */\nexport class TemplateRegistry {\n\tprivate templatesDir: string;\n\tprivate templatesCache: Map<string, Template> = new Map();\n\n\tconstructor(templatesDir?: string) {\n\t\t// Default to templates directory in project root\n\t\tthis.templatesDir = templatesDir || getTemplatesDir();\n\t}\n\n\t/**\n\t * Discover all templates in the templates directory\n\t */\n\tasync discoverTemplates(): Promise<TemplateConfig[]> {\n\t\ttry {\n\t\t\tconst entries = await readdir(this.templatesDir, { withFileTypes: true });\n\n\t\t\tconst templates: TemplateConfig[] = [];\n\n\t\t\tfor (const entry of entries) {\n\t\t\t\tif (!entry.isDirectory()) continue;\n\n\t\t\t\tconst templatePath = join(this.templatesDir, entry.name);\n\t\t\t\tconst configPath = join(templatePath, \"template.config.json\");\n\n\t\t\t\ttry {\n\t\t\t\t\t// Check if template.config.json exists\n\t\t\t\t\tawait access(configPath);\n\t\t\t\t} catch {\n\t\t\t\t\t// Silently skip directories without template.config.json\n\t\t\t\t\t// (they're not project templates, e.g., scaffolding/, utilities/, etc.)\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\t// Load and parse config\n\t\t\t\t\tconst configContent = await readFile(configPath, \"utf-8\");\n\t\t\t\t\tconst config = JSON.parse(configContent);\n\n\t\t\t\t\t// Validate config\n\t\t\t\t\tconst validation = validateTemplateConfig(config);\n\n\t\t\t\t\tif (validation.success && validation.data) {\n\t\t\t\t\t\ttemplates.push(validation.data);\n\n\t\t\t\t\t\t// Cache the template\n\t\t\t\t\t\tthis.templatesCache.set(validation.data.id, {\n\t\t\t\t\t\t\tconfig: validation.data,\n\t\t\t\t\t\t\tpath: templatePath,\n\t\t\t\t\t\t\tfilesPath: join(templatePath, \"files\"),\n\t\t\t\t\t\t\thooksPath: join(templatePath, \"hooks\"),\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Warn about templates with invalid config format\n\t\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t\t`Skipping template ${entry.name}: Invalid config format`,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\t// Warn about templates with parse errors or other issues\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t`Skipping template ${entry.name}: ${error instanceof Error ? error.message : String(error)}`,\n\t\t\t\t\t);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn templates;\n\t\t} catch (error) {\n\t\t\tthrow new Error(`Failed to discover templates: ${error}`);\n\t\t}\n\t}\n\n\t/**\n\t * Get a specific template by ID\n\t */\n\tasync getTemplate(id: string): Promise<Template> {\n\t\t// Check cache first\n\t\tif (this.templatesCache.has(id)) {\n\t\t\treturn this.templatesCache.get(id)!;\n\t\t}\n\n\t\t// Discover templates (which will populate cache)\n\t\tawait this.discoverTemplates();\n\n\t\t// Check cache again\n\t\tif (this.templatesCache.has(id)) {\n\t\t\treturn this.templatesCache.get(id)!;\n\t\t}\n\n\t\tthrow new Error(`Template not found: ${id}`);\n\t}\n\n\t/**\n\t * Validate a specific template\n\t */\n\tasync validateTemplate(id: string): Promise<TemplateValidationResult> {\n\t\tconst errors: string[] = [];\n\t\tconst warnings: string[] = [];\n\n\t\ttry {\n\t\t\tconst template = await this.getTemplate(id);\n\n\t\t\t// Validate config schema (already done in getTemplate)\n\t\t\t// Additional validations:\n\n\t\t\t// 1. Check if files directory exists\n\t\t\ttry {\n\t\t\t\tawait access(template.filesPath);\n\t\t\t} catch {\n\t\t\t\terrors.push(`Files directory not found: ${template.filesPath}`);\n\t\t\t}\n\n\t\t\t// 2. Check if required files exist\n\t\t\tconst requiredFiles = [\"package.json.hbs\", \"tsconfig.json\", \"README.md.hbs\"];\n\n\t\t\tfor (const file of requiredFiles) {\n\t\t\t\ttry {\n\t\t\t\t\tawait access(join(template.filesPath, file));\n\t\t\t\t} catch {\n\t\t\t\t\twarnings.push(`Recommended file missing: ${file}`);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// 3. Validate variables\n\t\t\tfor (const variable of template.config.scaffolding.variables) {\n\t\t\t\tif (variable.required && variable.default) {\n\t\t\t\t\twarnings.push(`Variable ${variable.name} is required but has a default value`);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// 4. Check capabilities\n\t\t\tif (template.config.capabilities.transport.length === 0) {\n\t\t\t\terrors.push(\"Template must support at least one transport\");\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tvalid: errors.length === 0,\n\t\t\t\terrors,\n\t\t\t\twarnings,\n\t\t\t};\n\t\t} catch (error) {\n\t\t\treturn {\n\t\t\t\tvalid: false,\n\t\t\t\terrors: [`Failed to validate template: ${error}`],\n\t\t\t\twarnings: [],\n\t\t\t};\n\t\t}\n\t}\n\n\t/**\n\t * List all templates with optional filtering\n\t */\n\tasync listTemplates(filter?: TemplateFilter): Promise<TemplateConfig[]> {\n\t\tconst templates = await this.discoverTemplates();\n\n\t\tif (!filter) {\n\t\t\treturn templates;\n\t\t}\n\n\t\treturn templates.filter((template) => {\n\t\t\t// Filter by runtime\n\t\t\tif (filter.runtime && template.capabilities.runtime !== filter.runtime) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Filter by transport\n\t\t\tif (filter.transport && !template.capabilities.transport.includes(filter.transport)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Filter by deployment\n\t\t\tif (filter.deployment && template.capabilities.deployment !== filter.deployment) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Filter by language\n\t\t\tif (filter.language && template.capabilities.language !== filter.language) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\t}\n\n\t/**\n\t * Check if a template exists\n\t */\n\tasync templateExists(id: string): Promise<boolean> {\n\t\ttry {\n\t\t\tawait this.getTemplate(id);\n\t\t\treturn true;\n\t\t} catch {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t/**\n\t * Get template capabilities (for filtering/discovery)\n\t */\n\tasync getCapabilities(): Promise<{\n\t\truntimes: Set<string>;\n\t\ttransports: Set<string>;\n\t\tdeployments: Set<string>;\n\t\tlanguages: Set<string>;\n\t}> {\n\t\tconst templates = await this.discoverTemplates();\n\n\t\tconst runtimes = new Set<string>();\n\t\tconst transports = new Set<string>();\n\t\tconst deployments = new Set<string>();\n\t\tconst languages = new Set<string>();\n\n\t\tfor (const template of templates) {\n\t\t\truntimes.add(template.capabilities.runtime);\n\t\t\tfor (const transport of template.capabilities.transport) {\n\t\t\t\ttransports.add(transport);\n\t\t\t}\n\t\t\tdeployments.add(template.capabilities.deployment);\n\t\t\tlanguages.add(template.capabilities.language);\n\t\t}\n\n\t\treturn { runtimes, transports, deployments, languages };\n\t}\n\n\t/**\n\t * Clear templates cache\n\t */\n\tclearCache(): void {\n\t\tthis.templatesCache.clear();\n\t}\n}\n","/**\n * Template Processor\n *\n * Handles scaffolding projects from templates:\n * - Variable substitution\n * - File copying\n * - Hook execution\n * - Dependency installation\n */\n\nimport { mkdir, readdir, readFile, writeFile, copyFile, stat } from \"node:fs/promises\";\nimport { join, dirname, basename } from \"node:path\";\nimport Handlebars from \"handlebars\";\nimport type {\n\tScaffoldOptions,\n\tScaffoldResult,\n\tScaffoldMetadata,\n\tTemplateHookContext,\n\tTemplate,\n\tTemplateVariable,\n} from \"./types.js\";\nimport { TemplateRegistry } from \"./registry.js\";\n\n/**\n * Template Processor - scaffolds projects from templates\n */\nexport class TemplateProcessor {\n\tprivate registry: TemplateRegistry;\n\n\tconstructor(registry: TemplateRegistry) {\n\t\tthis.registry = registry;\n\t}\n\n\t/**\n\t * Scaffold a project from a template\n\t */\n\tasync scaffold(options: ScaffoldOptions): Promise<ScaffoldResult> {\n\t\ttry {\n\t\t\t// 1. Load template\n\t\t\tconst template = await this.registry.getTemplate(options.template);\n\n\t\t\t// 2. Validate variables\n\t\t\tconst variables = this.validateVariables(\n\t\t\t\toptions.variables,\n\t\t\t\ttemplate.config.scaffolding.variables,\n\t\t\t);\n\n\t\t\t// 3. Create target directory\n\t\t\tawait mkdir(options.targetDir, { recursive: true });\n\n\t\t\t// 4. Run pre-scaffold hook (if exists)\n\t\t\tawait this.runHook(template, \"pre-scaffold\", {\n\t\t\t\ttemplate: template.config,\n\t\t\t\ttargetDir: options.targetDir,\n\t\t\t\tvariables,\n\t\t\t\tpackageManager: options.packageManager,\n\t\t\t});\n\n\t\t\t// 5. Copy template files with variable substitution\n\t\t\tawait this.copyTemplateFiles(template, options.targetDir, variables);\n\n\t\t\t// 6. Run post-scaffold hook (if exists)\n\t\t\tawait this.runHook(template, \"post-scaffold\", {\n\t\t\t\ttemplate: template.config,\n\t\t\t\ttargetDir: options.targetDir,\n\t\t\t\tvariables,\n\t\t\t\tpackageManager: options.packageManager,\n\t\t\t});\n\n\t\t\t// 7. Install dependencies (if enabled)\n\t\t\tif (!options.noInstall && template.config.scaffolding.postScaffold?.install) {\n\t\t\t\tawait this.installDependencies(\n\t\t\t\t\toptions.targetDir,\n\t\t\t\t\toptions.packageManager,\n\t\t\t\t\ttemplate.config.scaffolding.postScaffold.installCommand,\n\t\t\t\t);\n\n\t\t\t\t// 7.5. Run post-install commands (if configured)\n\t\t\t\tif (template.config.scaffolding.postScaffold?.postInstall) {\n\t\t\t\t\tawait this.runPostInstallCommands(\n\t\t\t\t\t\toptions.targetDir,\n\t\t\t\t\t\ttemplate.config.scaffolding.postScaffold.postInstall,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// 8. Run smoke test (if configured and requested)\n\t\t\tif (options.smokeTest && template.config.scaffolding.postScaffold?.smokeTest) {\n\t\t\t\tawait this.runSmokeTest(\n\t\t\t\t\toptions.targetDir,\n\t\t\t\t\ttemplate.config.scaffolding.postScaffold.smokeTest,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// 9. Write scaffold metadata\n\t\t\tawait this.writeMetadata(options.targetDir, template, variables);\n\n\t\t\treturn {\n\t\t\t\tsuccess: true,\n\t\t\t\ttemplate: template.config.id,\n\t\t\t\tpath: options.targetDir,\n\t\t\t};\n\t\t} catch (error) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\ttemplate: options.template,\n\t\t\t\tpath: options.targetDir,\n\t\t\t\terror: error instanceof Error ? error.message : String(error),\n\t\t\t};\n\t\t}\n\t}\n\n\t/**\n\t * Validate and merge variables with defaults\n\t */\n\tprivate validateVariables(\n\t\tprovided: Record<string, string>,\n\t\tdefinitions: TemplateVariable[],\n\t): Record<string, string> {\n\t\tconst variables: Record<string, string> = {};\n\n\t\tfor (const def of definitions) {\n\t\t\t// Check if required variable is provided\n\t\t\tif (def.required && !provided[def.name]) {\n\t\t\t\tthrow new Error(`Required variable missing: ${def.name}`);\n\t\t\t}\n\n\t\t\t// Use provided value or default\n\t\t\tconst value = provided[def.name] || def.default || \"\";\n\n\t\t\t// Validate pattern (if specified)\n\t\t\tif (def.pattern && value) {\n\t\t\t\tconst regex = new RegExp(def.pattern);\n\t\t\t\tif (!regex.test(value)) {\n\t\t\t\t\tthrow new Error(`Variable ${def.name} does not match pattern: ${def.pattern}`);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvariables[def.name] = value;\n\t\t}\n\n\t\t// Include any extra variables not in definitions\n\t\tfor (const [key, value] of Object.entries(provided)) {\n\t\t\tif (!variables[key]) {\n\t\t\t\tvariables[key] = value;\n\t\t\t}\n\t\t}\n\n\t\treturn variables;\n\t}\n\n\t/**\n\t * Copy template files to target directory with variable substitution\n\t */\n\tprivate async copyTemplateFiles(\n\t\ttemplate: Template,\n\t\ttargetDir: string,\n\t\tvariables: Record<string, string>,\n\t): Promise<void> {\n\t\tawait this.copyDirectoryRecursive(template.filesPath, targetDir, variables);\n\t}\n\n\t/**\n\t * Recursively copy directory with variable substitution\n\t */\n\tprivate async copyDirectoryRecursive(\n\t\tsourceDir: string,\n\t\ttargetDir: string,\n\t\tvariables: Record<string, string>,\n\t): Promise<void> {\n\t\tconst entries = await readdir(sourceDir, { withFileTypes: true });\n\n\t\tfor (const entry of entries) {\n\t\t\tconst sourcePath = join(sourceDir, entry.name);\n\t\t\tlet targetPath = join(targetDir, entry.name);\n\n\t\t\t// Process filename (remove .hbs extension, substitute variables)\n\t\t\tif (entry.name.endsWith(\".hbs\")) {\n\t\t\t\ttargetPath = join(targetDir, entry.name.slice(0, -4)); // Remove .hbs\n\t\t\t}\n\n\t\t\tif (entry.isDirectory()) {\n\t\t\t\t// Create directory and recurse\n\t\t\t\tawait mkdir(targetPath, { recursive: true });\n\t\t\t\tawait this.copyDirectoryRecursive(sourcePath, targetPath, variables);\n\t\t\t} else {\n\t\t\t\t// Process file\n\t\t\t\tawait this.processFile(sourcePath, targetPath, variables);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Process a single file (with or without Handlebars templating)\n\t */\n\tprivate async processFile(\n\t\tsourcePath: string,\n\t\ttargetPath: string,\n\t\tvariables: Record<string, string>,\n\t): Promise<void> {\n\t\t// Ensure target directory exists\n\t\tawait mkdir(dirname(targetPath), { recursive: true });\n\n\t\t// Check if file should be templated\n\t\tif (sourcePath.endsWith(\".hbs\")) {\n\t\t\t// Read template file\n\t\t\tconst templateContent = await readFile(sourcePath, \"utf-8\");\n\n\t\t\t// Compile and execute Handlebars template\n\t\t\tconst template = Handlebars.compile(templateContent);\n\t\t\tconst processedContent = template(variables);\n\n\t\t\t// Write processed file\n\t\t\tawait writeFile(targetPath, processedContent, \"utf-8\");\n\t\t} else {\n\t\t\t// Binary file or non-templated file - just copy\n\t\t\tawait copyFile(sourcePath, targetPath);\n\t\t}\n\t}\n\n\t/**\n\t * Run a template hook\n\t */\n\tprivate async runHook(\n\t\ttemplate: Template,\n\t\thookName: string,\n\t\tcontext: TemplateHookContext,\n\t): Promise<void> {\n\t\tif (!template.hooksPath) return;\n\n\t\tconst hookPath = join(template.hooksPath, `${hookName}.js`);\n\n\t\ttry {\n\t\t\t// Check if hook exists\n\t\t\tawait stat(hookPath);\n\n\t\t\t// Import and execute hook\n\t\t\tconst hook = await import(hookPath);\n\n\t\t\tif (typeof hook.default === \"function\") {\n\t\t\t\tawait hook.default(context);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\t// Only warn if hook exists but failed to execute\n\t\t\t// Don't warn if hook doesn't exist (ENOENT) - hooks are optional\n\t\t\tconst isNotFound = error instanceof Error &&\n\t\t\t\t'code' in error &&\n\t\t\t\t(error as NodeJS.ErrnoException).code === 'ENOENT';\n\n\t\t\tif (!isNotFound) {\n\t\t\t\tconsole.warn(`  Hook ${hookName} failed: ${error instanceof Error ? error.message : String(error)}`);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Install dependencies\n\t */\n\tprivate async installDependencies(\n\t\ttargetDir: string,\n\t\tpackageManager: string | undefined,\n\t\tcustomCommand?: string,\n\t): Promise<void> {\n\t\tconst { spawn } = await import(\"node:child_process\");\n\n\t\t// Use custom command or detect package manager\n\t\tconst command = customCommand || this.getInstallCommand(packageManager);\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst [cmd, ...args] = command.split(\" \");\n\n\t\t\tconst proc = spawn(cmd, args, {\n\t\t\t\tcwd: targetDir,\n\t\t\t\tstdio: \"inherit\",\n\t\t\t\tshell: true,\n\t\t\t});\n\n\t\t\tproc.on(\"close\", (code) => {\n\t\t\t\tif (code === 0) {\n\t\t\t\t\tresolve();\n\t\t\t\t} else {\n\t\t\t\t\treject(new Error(`Install command failed with code ${code}`));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tproc.on(\"error\", (error) => {\n\t\t\t\treject(error);\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Run post-install commands\n\t */\n\tprivate async runPostInstallCommands(\n\t\ttargetDir: string,\n\t\tcommands: string[],\n\t): Promise<void> {\n\t\tconst { spawn } = await import(\"node:child_process\");\n\n\t\tconsole.log(`\\n Running ${commands.length} post-install command(s)...\\n`);\n\n\t\tfor (const command of commands) {\n\t\t\tawait new Promise<void>((resolve, reject) => {\n\t\t\t\tconst [cmd, ...args] = command.split(\" \");\n\n\t\t\t\tconst proc = spawn(cmd, args, {\n\t\t\t\t\tcwd: targetDir,\n\t\t\t\t\tstdio: \"inherit\",\n\t\t\t\t\tshell: true,\n\t\t\t\t});\n\n\t\t\t\tproc.on(\"close\", (code) => {\n\t\t\t\t\tif (code === 0) {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(new Error(`Post-install command \"${command}\" failed with code ${code}`));\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tproc.on(\"error\", (error) => {\n\t\t\t\t\treject(error);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Get install command for package manager\n\t */\n\tprivate getInstallCommand(packageManager?: string): string {\n\t\tswitch (packageManager) {\n\t\t\tcase \"pnpm\":\n\t\t\t\treturn \"pnpm install\";\n\t\t\tcase \"yarn\":\n\t\t\t\treturn \"yarn install\";\n\t\t\tcase \"bun\":\n\t\t\t\treturn \"bun install\";\n\t\t\tcase \"npm\":\n\t\t\tdefault:\n\t\t\t\treturn \"npm install\";\n\t\t}\n\t}\n\n\t/**\n\t * Run smoke test\n\t */\n\tprivate async runSmokeTest(targetDir: string, smokeTestCommand: string): Promise<void> {\n\t\tconst { spawn } = await import(\"node:child_process\");\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst [cmd, ...args] = smokeTestCommand.split(\" \");\n\n\t\t\tconst proc = spawn(cmd, args, {\n\t\t\t\tcwd: targetDir,\n\t\t\t\tstdio: \"inherit\",\n\t\t\t\tshell: true,\n\t\t\t});\n\n\t\t\tproc.on(\"close\", (code) => {\n\t\t\t\tif (code === 0) {\n\t\t\t\t\tresolve();\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(`Smoke test failed with code ${code} (continuing anyway)`);\n\t\t\t\t\tresolve(); // Don't fail scaffolding due to smoke test failure\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tproc.on(\"error\", (error) => {\n\t\t\t\tconsole.warn(`Smoke test error: ${error} (continuing anyway)`);\n\t\t\t\tresolve(); // Don't fail scaffolding\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Write scaffold metadata to .mcp-template.json\n\t */\n\tprivate async writeMetadata(\n\t\ttargetDir: string,\n\t\ttemplate: Template,\n\t\tvariables: Record<string, string>,\n\t): Promise<void> {\n\t\tconst metadata: ScaffoldMetadata = {\n\t\t\tid: template.config.id,\n\t\t\tversion: template.config.version,\n\t\t\tname: template.config.name,\n\t\t\tmcp_sdk_version: template.config.dependencies.mcp_sdk,\n\t\t\tagents_version: template.config.dependencies.agents,\n\t\t\tscaffolded_at: new Date().toISOString(),\n\t\t\tvariables,\n\t\t};\n\n\t\tconst metadataPath = join(targetDir, \".mcp-template.json\");\n\t\tawait writeFile(metadataPath, JSON.stringify(metadata, null, \"\\t\"), \"utf-8\");\n\t}\n}\n","/**\n * Convert JSON Schema to Zod schema for validation\n * Supports OpenAPI 3.0 JSON Schema subset\n */\n\nimport { z } from \"zod\";\n\n/**\n * Custom format validators\n */\nconst formatValidators = {\n\temail: (val: string) => z.string().email().safeParse(val).success,\n\turi: (val: string) => {\n\t\ttry {\n\t\t\tnew URL(val);\n\t\t\treturn true;\n\t\t} catch {\n\t\t\treturn false;\n\t\t}\n\t},\n\turl: (val: string) => formatValidators.uri(val),\n\tuuid: (val: string) =>\n\t\t/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(val),\n\tdate: (val: string) => /^\\d{4}-\\d{2}-\\d{2}$/.test(val),\n\t\"date-time\": (val: string) => !isNaN(Date.parse(val)),\n\ttime: (val: string) => /^\\d{2}:\\d{2}:\\d{2}/.test(val),\n\tipv4: (val: string) => /^(\\d{1,3}\\.){3}\\d{1,3}$/.test(val),\n\tipv6: (val: string) => /^([0-9a-f]{1,4}:){7}[0-9a-f]{1,4}$/i.test(val),\n\t// Custom VA formats\n\tssn: (val: string) => /^\\d{3}-\\d{2}-\\d{4}$/.test(val),\n\tphone: (val: string) => /^\\d{3}-\\d{3}-\\d{4}$/.test(val),\n};\n\n/**\n * Convert a JSON Schema to a Zod schema\n */\nexport function jsonSchemaToZod(schema: any): z.ZodTypeAny {\n\t// Handle $ref (should be dereferenced already in most cases)\n\tif (schema.$ref) {\n\t\tthrow new Error(`Unresolved $ref: ${schema.$ref}. Schema should be dereferenced first.`);\n\t}\n\n\t// Handle oneOf, anyOf, allOf\n\tif (schema.oneOf) {\n\t\tconst schemas = schema.oneOf.map((s: any) => jsonSchemaToZod(s));\n\t\treturn z.union(schemas as [z.ZodTypeAny, z.ZodTypeAny, ...z.ZodTypeAny[]]);\n\t}\n\n\tif (schema.anyOf) {\n\t\tconst schemas = schema.anyOf.map((s: any) => jsonSchemaToZod(s));\n\t\treturn z.union(schemas as [z.ZodTypeAny, z.ZodTypeAny, ...z.ZodTypeAny[]]);\n\t}\n\n\tif (schema.allOf) {\n\t\t// For allOf, we merge the schemas\n\t\t// This is a simplified implementation - full allOf support is complex\n\t\tconst merged = schema.allOf.reduce((acc: any, curr: any) => {\n\t\t\treturn {\n\t\t\t\t...acc,\n\t\t\t\t...curr,\n\t\t\t\tproperties: { ...(acc.properties || {}), ...(curr.properties || {}) },\n\t\t\t\trequired: [...(acc.required || []), ...(curr.required || [])],\n\t\t\t};\n\t\t}, {});\n\t\treturn jsonSchemaToZod(merged);\n\t}\n\n\t// Handle by type\n\t// If no explicit type but has object-like properties, infer it's an object\n\t// This handles malformed OpenAPI specs that omit \"type\": \"object\"\n\tlet type = schema.type;\n\tif (!type && (schema.properties || schema.required)) {\n\t\ttype = \"object\";\n\t}\n\n\tswitch (type) {\n\t\tcase \"string\":\n\t\t\treturn createStringSchema(schema);\n\n\t\tcase \"number\":\n\t\t\treturn createNumberSchema(schema, false);\n\n\t\tcase \"integer\":\n\t\t\treturn createNumberSchema(schema, true);\n\n\t\tcase \"boolean\":\n\t\t\treturn z.boolean();\n\n\t\tcase \"null\":\n\t\t\treturn z.null();\n\n\t\tcase \"array\":\n\t\t\treturn createArraySchema(schema);\n\n\t\tcase \"object\":\n\t\t\treturn createObjectSchema(schema);\n\n\t\tdefault:\n\t\t\t// If no type specified, accept any\n\t\t\treturn z.any();\n\t}\n}\n\n/**\n * Create Zod string schema with formats and constraints\n */\nfunction createStringSchema(schema: any): z.ZodTypeAny {\n\t// Handle enum first - must return enum type, not string\n\tif (schema.enum) {\n\t\treturn z.enum(schema.enum as [string, ...string[]]);\n\t}\n\n\tlet zodSchema: z.ZodString | z.ZodEffects<z.ZodString> = z.string();\n\n\t// Handle length constraints first (these work on ZodString)\n\tif (schema.minLength !== undefined) {\n\t\tzodSchema = zodSchema.min(schema.minLength);\n\t}\n\tif (schema.maxLength !== undefined) {\n\t\tzodSchema = zodSchema.max(schema.maxLength);\n\t}\n\n\t// Handle pattern (must be before refine/format validators)\n\tif (schema.pattern) {\n\t\tconst regex = new RegExp(schema.pattern);\n\t\tzodSchema = zodSchema.regex(regex, {\n\t\t\tmessage: `Does not match pattern: ${schema.pattern}`,\n\t\t});\n\t}\n\n\t// Handle format last (refine returns ZodEffects which doesn't support regex)\n\tif (schema.format) {\n\t\tconst format = schema.format;\n\t\tconst validator = formatValidators[format as keyof typeof formatValidators];\n\n\t\tif (validator) {\n\t\t\tzodSchema = zodSchema.refine(validator, {\n\t\t\t\tmessage: `Invalid ${format} format`,\n\t\t\t});\n\t\t} else if (format === \"email\") {\n\t\t\tzodSchema = (zodSchema as z.ZodString).email();\n\t\t} else if (format === \"url\" || format === \"uri\") {\n\t\t\tzodSchema = (zodSchema as z.ZodString).url();\n\t\t}\n\t}\n\n\treturn zodSchema;\n}\n\n/**\n * Create Zod number schema with constraints\n */\nfunction createNumberSchema(schema: any, isInteger: boolean): z.ZodTypeAny {\n\tlet zodSchema = z.number();\n\n\tif (isInteger) {\n\t\tzodSchema = zodSchema.int();\n\t}\n\n\t// Handle enum\n\tif (schema.enum) {\n\t\treturn z.enum(schema.enum.map(String) as [string, ...string[]]).transform(Number);\n\t}\n\n\t// Handle constraints\n\tif (schema.minimum !== undefined) {\n\t\tzodSchema = zodSchema.min(schema.minimum);\n\t}\n\tif (schema.maximum !== undefined) {\n\t\tzodSchema = zodSchema.max(schema.maximum);\n\t}\n\tif (schema.exclusiveMinimum !== undefined) {\n\t\tzodSchema = zodSchema.gt(schema.exclusiveMinimum);\n\t}\n\tif (schema.exclusiveMaximum !== undefined) {\n\t\tzodSchema = zodSchema.lt(schema.exclusiveMaximum);\n\t}\n\tif (schema.multipleOf !== undefined) {\n\t\tzodSchema = zodSchema.multipleOf(schema.multipleOf);\n\t}\n\n\treturn zodSchema;\n}\n\n/**\n * Create Zod array schema\n */\nfunction createArraySchema(schema: any): z.ZodArray<any> {\n\tconst items = schema.items || {};\n\tconst itemSchema = jsonSchemaToZod(items);\n\n\tlet zodSchema = z.array(itemSchema);\n\n\t// Handle length constraints\n\tif (schema.minItems !== undefined) {\n\t\tzodSchema = zodSchema.min(schema.minItems);\n\t}\n\tif (schema.maxItems !== undefined) {\n\t\tzodSchema = zodSchema.max(schema.maxItems);\n\t}\n\n\treturn zodSchema;\n}\n\n/**\n * Create Zod object schema\n */\nfunction createObjectSchema(schema: any): z.ZodObject<any> {\n\tconst properties = schema.properties || {};\n\tconst required = schema.required || [];\n\tconst additionalProperties = schema.additionalProperties;\n\n\tconst shape: Record<string, z.ZodTypeAny> = {};\n\n\tfor (const key in properties) {\n\t\tconst propSchema = jsonSchemaToZod(properties[key]);\n\n\t\t// Make optional if not in required array\n\t\tif (required.includes(key)) {\n\t\t\tshape[key] = propSchema;\n\t\t} else {\n\t\t\tshape[key] = propSchema.optional();\n\t\t}\n\t}\n\n\t// Handle additionalProperties\n\t// If additionalProperties is false, use strict mode\n\t// If additionalProperties is true or undefined, use passthrough mode\n\tlet zodObject = z.object(shape);\n\n\tif (additionalProperties === false) {\n\t\tzodObject = zodObject.strict() as any;\n\t} else {\n\t\tzodObject = zodObject.passthrough() as any;\n\t}\n\n\treturn zodObject;\n}\n\n/**\n * Get a human-readable error message for a Zod issue\n */\nexport function getZodErrorMessage(issue: z.ZodIssue, schema: any): string {\n\tconst { code, path, message } = issue;\n\n\tswitch (code) {\n\t\tcase \"invalid_type\":\n\t\t\treturn `Invalid type: expected ${issue.expected}`;\n\n\t\tcase \"invalid_string\":\n\t\t\tif (issue.validation === \"email\") {\n\t\t\t\treturn \"Invalid email format\";\n\t\t\t}\n\t\t\tif (issue.validation === \"url\") {\n\t\t\t\treturn \"Invalid URL format\";\n\t\t\t}\n\t\t\tif (issue.validation === \"regex\") {\n\t\t\t\treturn message || \"Does not match required pattern\";\n\t\t\t}\n\t\t\treturn message;\n\n\t\tcase \"too_small\":\n\t\t\tif (issue.type === \"string\") {\n\t\t\t\treturn `Too short: minimum length is ${issue.minimum}`;\n\t\t\t}\n\t\t\tif (issue.type === \"number\") {\n\t\t\t\treturn `Too small: minimum value is ${issue.minimum}`;\n\t\t\t}\n\t\t\tif (issue.type === \"array\") {\n\t\t\t\treturn `Too few items: minimum is ${issue.minimum}`;\n\t\t\t}\n\t\t\treturn message;\n\n\t\tcase \"too_big\":\n\t\t\tif (issue.type === \"string\") {\n\t\t\t\treturn `Too long: maximum length is ${issue.maximum}`;\n\t\t\t}\n\t\t\tif (issue.type === \"number\") {\n\t\t\t\treturn `Too large: maximum value is ${issue.maximum}`;\n\t\t\t}\n\t\t\tif (issue.type === \"array\") {\n\t\t\t\treturn `Too many items: maximum is ${issue.maximum}`;\n\t\t\t}\n\t\t\treturn message;\n\n\t\tcase \"invalid_enum_value\":\n\t\t\treturn `Invalid value. Allowed values: ${issue.options.join(\", \")}`;\n\n\t\tcase \"custom\":\n\t\t\treturn message || \"Validation failed\";\n\n\t\tdefault:\n\t\t\treturn message || \"Validation error\";\n\t}\n}\n","/**\n * Generate example payloads from JSON schemas\n */\n\nexport class ExampleGenerator {\n\tprivate static readonly MAX_DEPTH = 5;\n\n\t/**\n\t * Generate example payload from JSON schema\n\t */\n\tstatic generate(schema: any, options?: { requiredOnly?: boolean; depth?: number }): any {\n\t\tconst depth = options?.depth || 0;\n\n\t\t// Prevent infinite recursion\n\t\tif (depth > this.MAX_DEPTH) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (!schema || typeof schema !== \"object\") {\n\t\t\treturn null;\n\t\t}\n\n\t\t// Handle $ref (should be dereferenced already, but just in case)\n\t\tif (schema.$ref) {\n\t\t\treturn `<reference: ${schema.$ref}>`;\n\t\t}\n\n\t\t// Use provided example if available\n\t\tif (schema.example !== undefined) {\n\t\t\treturn schema.example;\n\t\t}\n\n\t\t// Use default if available\n\t\tif (schema.default !== undefined) {\n\t\t\treturn schema.default;\n\t\t}\n\n\t\t// Handle by type\n\t\tswitch (schema.type) {\n\t\t\tcase \"object\":\n\t\t\t\treturn this.generateObject(schema, { ...options, depth });\n\n\t\t\tcase \"array\":\n\t\t\t\treturn this.generateArray(schema, { ...options, depth });\n\n\t\t\tcase \"string\":\n\t\t\t\treturn this.generateString(schema);\n\n\t\t\tcase \"number\":\n\t\t\tcase \"integer\":\n\t\t\t\treturn this.generateNumber(schema);\n\n\t\t\tcase \"boolean\":\n\t\t\t\treturn this.generateBoolean(schema);\n\n\t\t\tcase \"null\":\n\t\t\t\treturn null;\n\n\t\t\tdefault:\n\t\t\t\t// Handle oneOf, anyOf, allOf\n\t\t\t\tif (schema.oneOf && Array.isArray(schema.oneOf) && schema.oneOf.length > 0) {\n\t\t\t\t\treturn this.generate(schema.oneOf[0], { ...options, depth: depth + 1 });\n\t\t\t\t}\n\n\t\t\t\tif (schema.anyOf && Array.isArray(schema.anyOf) && schema.anyOf.length > 0) {\n\t\t\t\t\treturn this.generate(schema.anyOf[0], { ...options, depth: depth + 1 });\n\t\t\t\t}\n\n\t\t\t\tif (schema.allOf && Array.isArray(schema.allOf)) {\n\t\t\t\t\t// Merge all schemas\n\t\t\t\t\tconst merged: any = { type: \"object\", properties: {} };\n\t\t\t\t\tfor (const subSchema of schema.allOf) {\n\t\t\t\t\t\tif (subSchema.properties) {\n\t\t\t\t\t\t\tObject.assign(merged.properties, subSchema.properties);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (subSchema.required) {\n\t\t\t\t\t\t\tmerged.required = [...(merged.required || []), ...subSchema.required];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn this.generate(merged, { ...options, depth: depth + 1 });\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t}\n\t}\n\n\t/**\n\t * Generate example object\n\t */\n\tprivate static generateObject(\n\t\tschema: any,\n\t\toptions?: { requiredOnly?: boolean; depth?: number },\n\t): any {\n\t\tconst obj: any = {};\n\t\tconst properties = schema.properties || {};\n\t\tconst required = schema.required || [];\n\t\tconst depth = options?.depth || 0;\n\n\t\tfor (const prop in properties) {\n\t\t\t// Skip optional properties if requiredOnly is true\n\t\t\tif (options?.requiredOnly && !required.includes(prop)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Sanitize property name (ensure it's valid for JSON)\n\t\t\tconst safeProp = this.sanitizePropertyName(prop);\n\t\t\tif (!safeProp) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst value = this.generate(properties[prop], { ...options, depth: depth + 1 });\n\n\t\t\t// Only add property if value is not undefined\n\t\t\tif (value !== undefined) {\n\t\t\t\tobj[safeProp] = value;\n\t\t\t}\n\t\t}\n\n\t\treturn obj;\n\t}\n\n\t/**\n\t * Sanitize property name to ensure it's valid for JSON\n\t */\n\tprivate static sanitizePropertyName(prop: string): string | null {\n\t\tif (!prop || typeof prop !== \"string\") {\n\t\t\treturn null;\n\t\t}\n\n\t\t// Remove invalid characters but keep alphanumeric, underscore, hyphen, and dollar sign\n\t\tconst sanitized = prop.replace(/[^a-zA-Z0-9_$-]/g, \"_\");\n\n\t\t// Ensure property name is not empty after sanitization\n\t\treturn sanitized.length > 0 ? sanitized : null;\n\t}\n\n\t/**\n\t * Generate example array\n\t */\n\tprivate static generateArray(\n\t\tschema: any,\n\t\toptions?: { requiredOnly?: boolean; depth?: number },\n\t): any[] {\n\t\tif (!schema.items) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst depth = options?.depth || 0;\n\n\t\t// Generate example items, respecting minItems but capping at 10 to prevent huge examples\n\t\tconst minItems = schema.minItems || 1;\n\t\tconst itemCount = Math.min(minItems, 10);\n\t\tconst items = [];\n\n\t\tfor (let i = 0; i < itemCount; i++) {\n\t\t\tconst item = this.generate(schema.items, { ...options, depth: depth + 1 });\n\t\t\t// Only add item if it's not undefined\n\t\t\tif (item !== undefined) {\n\t\t\t\titems.push(item);\n\t\t\t}\n\t\t}\n\n\t\treturn items;\n\t}\n\n\t/**\n\t * Generate example string\n\t */\n\tprivate static generateString(schema: any): string {\n\t\t// Handle enum\n\t\tif (schema.enum && schema.enum.length > 0) {\n\t\t\treturn schema.enum[0];\n\t\t}\n\n\t\t// Handle format\n\t\tif (schema.format) {\n\t\t\treturn this.generateFormattedString(schema.format);\n\t\t}\n\n\t\t// Handle pattern\n\t\tif (schema.pattern) {\n\t\t\treturn this.generatePatternString(schema.pattern);\n\t\t}\n\n\t\t// Default string\n\t\treturn \"string\";\n\t}\n\n\t/**\n\t * Generate formatted string\n\t */\n\tprivate static generateFormattedString(format: string): string {\n\t\tswitch (format) {\n\t\t\tcase \"email\":\n\t\t\t\treturn \"user@example.com\";\n\t\t\tcase \"date\":\n\t\t\t\treturn \"2024-01-15\";\n\t\t\tcase \"date-time\":\n\t\t\t\treturn \"2024-01-15T10:30:00Z\";\n\t\t\tcase \"uri\":\n\t\t\tcase \"url\":\n\t\t\t\treturn \"https://example.com\";\n\t\t\tcase \"uuid\":\n\t\t\t\treturn \"123e4567-e89b-12d3-a456-426614174000\";\n\t\t\tcase \"ipv4\":\n\t\t\t\treturn \"192.168.1.1\";\n\t\t\tcase \"ipv6\":\n\t\t\t\treturn \"2001:0db8:85a3:0000:0000:8a2e:0370:7334\";\n\t\t\tcase \"ssn\":\n\t\t\t\treturn \"123-45-6789\";\n\t\t\tcase \"phone\":\n\t\t\t\treturn \"555-123-4567\";\n\t\t\tdefault:\n\t\t\t\treturn \"string\";\n\t\t}\n\t}\n\n\t/**\n\t * Generate string matching a pattern\n\t */\n\tprivate static generatePatternString(pattern: string): string {\n\t\t// Handle common patterns\n\t\tif (pattern.includes(\"\\\\d{3}-\\\\d{2}-\\\\d{4}\")) {\n\t\t\treturn \"123-45-6789\"; // SSN\n\t\t}\n\n\t\tif (pattern.includes(\"\\\\d{3}-\\\\d{3}-\\\\d{4}\")) {\n\t\t\treturn \"555-123-4567\"; // Phone\n\t\t}\n\n\t\tif (pattern.includes(\"^[A-Z]{2}\\\\d{6}$\")) {\n\t\t\treturn \"AB123456\"; // ID pattern\n\t\t}\n\n\t\t// Default\n\t\treturn \"string\";\n\t}\n\n\t/**\n\t * Generate example number\n\t */\n\tprivate static generateNumber(schema: any): number {\n\t\t// Handle enum\n\t\tif (schema.enum && schema.enum.length > 0) {\n\t\t\treturn schema.enum[0];\n\t\t}\n\n\t\t// Use minimum if available\n\t\tif (schema.minimum !== undefined) {\n\t\t\treturn schema.minimum;\n\t\t}\n\n\t\t// Use maximum if available\n\t\tif (schema.maximum !== undefined) {\n\t\t\treturn schema.maximum;\n\t\t}\n\n\t\t// Default\n\t\treturn schema.type === \"integer\" ? 0 : 0.0;\n\t}\n\n\t/**\n\t * Generate example boolean\n\t */\n\tprivate static generateBoolean(schema: any): boolean {\n\t\treturn true;\n\t}\n}\n","/**\n * Utility for formatting validation errors for user-friendly display\n */\n\nimport type { ValidationError, ValidationWarning } from \"../types/mcp-tools.js\";\n\nexport class ErrorFormatter {\n\t/**\n\t * Format validation errors into a readable text summary\n\t */\n\tstatic formatErrors(errors: ValidationError[]): string {\n\t\tif (errors.length === 0) {\n\t\t\treturn \"No errors\";\n\t\t}\n\n\t\tconst lines = [`Found ${errors.length} validation error${errors.length === 1 ? \"\" : \"s\"}:\\n`];\n\n\t\tfor (let i = 0; i < errors.length; i++) {\n\t\t\tconst error = errors[i];\n\t\t\tlines.push(`${i + 1}. Field: ${error.field}`);\n\t\t\tlines.push(`   Error: ${error.message}`);\n\n\t\t\tif (error.expected) {\n\t\t\t\tlines.push(`   Expected: ${JSON.stringify(error.expected)}`);\n\t\t\t}\n\n\t\t\tif (error.received) {\n\t\t\t\tlines.push(`   Received: ${JSON.stringify(error.received)}`);\n\t\t\t}\n\n\t\t\tif (error.fixSuggestion) {\n\t\t\t\tlines.push(`   Fix: ${error.fixSuggestion}`);\n\t\t\t}\n\n\t\t\tlines.push(\"\");\n\t\t}\n\n\t\treturn lines.join(\"\\n\");\n\t}\n\n\t/**\n\t * Format validation warnings into a readable text summary\n\t */\n\tstatic formatWarnings(warnings: ValidationWarning[]): string {\n\t\tif (warnings.length === 0) {\n\t\t\treturn \"\";\n\t\t}\n\n\t\tconst lines = [`\\nFound ${warnings.length} warning${warnings.length === 1 ? \"\" : \"s\"}:\\n`];\n\n\t\tfor (let i = 0; i < warnings.length; i++) {\n\t\t\tconst warning = warnings[i];\n\t\t\tlines.push(`${i + 1}. Field: ${warning.field}`);\n\t\t\tlines.push(`   Warning: ${warning.message}`);\n\n\t\t\tif (warning.suggestion) {\n\t\t\t\tlines.push(`   Suggestion: ${warning.suggestion}`);\n\t\t\t}\n\n\t\t\tlines.push(\"\");\n\t\t}\n\n\t\treturn lines.join(\"\\n\");\n\t}\n\n\t/**\n\t * Format complete validation result\n\t */\n\tstatic formatValidationResult(result: {\n\t\tvalid: boolean;\n\t\terrors: ValidationError[];\n\t\twarnings?: ValidationWarning[];\n\t}): string {\n\t\tif (result.valid) {\n\t\t\tlet output = \" Payload is valid\";\n\n\t\t\tif (result.warnings && result.warnings.length > 0) {\n\t\t\t\toutput += \"\\n\\n\" + this.formatWarnings(result.warnings);\n\t\t\t}\n\n\t\t\treturn output;\n\t\t}\n\n\t\treturn \" Payload validation failed\\n\\n\" + this.formatErrors(result.errors);\n\t}\n}\n","/**\n * LRU Cache with TTL for OpenAPI specs and metadata\n */\n\ninterface CacheEntry<T> {\n\tvalue: T;\n\ttimestamp: number;\n}\n\nexport class LRUCache<T> {\n\tprivate cache: Map<string, CacheEntry<T>>;\n\tprivate readonly maxSize: number;\n\tprivate readonly ttlMs: number;\n\n\tconstructor(maxSize: number = 50, ttlMinutes: number = 60) {\n\t\tthis.cache = new Map();\n\t\tthis.maxSize = maxSize;\n\t\tthis.ttlMs = ttlMinutes * 60 * 1000;\n\t}\n\n\tget(key: string): T | null {\n\t\tconst entry = this.cache.get(key);\n\n\t\tif (!entry) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// Check if expired\n\t\tif (Date.now() - entry.timestamp > this.ttlMs) {\n\t\t\tthis.cache.delete(key);\n\t\t\treturn null;\n\t\t}\n\n\t\t// Move to end (most recently used)\n\t\tthis.cache.delete(key);\n\t\tthis.cache.set(key, entry);\n\n\t\treturn entry.value;\n\t}\n\n\tset(key: string, value: T): void {\n\t\t// Remove if exists (to update position)\n\t\tif (this.cache.has(key)) {\n\t\t\tthis.cache.delete(key);\n\t\t}\n\n\t\t// If at max size, remove least recently used (first item)\n\t\tif (this.cache.size >= this.maxSize) {\n\t\t\tconst firstKey = this.cache.keys().next().value;\n\t\t\tif (firstKey !== undefined) {\n\t\t\t\tthis.cache.delete(firstKey);\n\t\t\t}\n\t\t}\n\n\t\t// Add new entry\n\t\tthis.cache.set(key, {\n\t\t\tvalue,\n\t\t\ttimestamp: Date.now(),\n\t\t});\n\t}\n\n\thas(key: string): boolean {\n\t\tconst entry = this.cache.get(key);\n\n\t\tif (!entry) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Check if expired\n\t\tif (Date.now() - entry.timestamp > this.ttlMs) {\n\t\t\tthis.cache.delete(key);\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tdelete(key: string): void {\n\t\tthis.cache.delete(key);\n\t}\n\n\tclear(): void {\n\t\tthis.cache.clear();\n\t}\n\n\tsize(): number {\n\t\treturn this.cache.size;\n\t}\n\n\tkeys(): string[] {\n\t\treturn Array.from(this.cache.keys());\n\t}\n\n\t// Clean up expired entries\n\tcleanup(): number {\n\t\tconst now = Date.now();\n\t\tlet cleaned = 0;\n\n\t\tfor (const [key, entry] of this.cache.entries()) {\n\t\t\tif (now - entry.timestamp > this.ttlMs) {\n\t\t\t\tthis.cache.delete(key);\n\t\t\t\tcleaned++;\n\t\t\t}\n\t\t}\n\n\t\treturn cleaned;\n\t}\n}\n\n// Singleton cache instances\nexport const metadataCache = new LRUCache<any>(50, 60); // 50 items, 1 hour TTL\nexport const openApiCache = new LRUCache<any>(50, 60); // 50 specs, 1 hour TTL\nexport const promptCache = new LRUCache<any>(50, 60); // 50 prompts, 1 hour TTL\nexport const resourceCache = new LRUCache<any>(100, 30); // 100 resources, 30 min TTL\n","/**\n * MCP Server Kit - Main Package Entry Point\n *\n * Extensible scaffolding tool and test harness for Model Context Protocol servers.\n */\n\n// Re-export harness for independent usage\nexport * from \"./harness/index.js\";\n\n// Re-export template system\nexport * from \"./core/template-system/index.js\";\n\n// Re-export utilities\nexport * from \"./utils/index.js\";\n\n// Re-export services\nexport * from \"./services/index.js\";\n\n// Package metadata\nexport const VERSION = \"1.0.0\";\nexport const NAME = \"mcp-server-kit\";\n"]}